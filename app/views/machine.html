<div class="machineview">
	
	<section id="section-navbtns" class="section-navbtns row">
        <div id="breadcrumb" class="col-md-8 padding-left-0">
            <a href="#/machines/list">Machines</a> >
            <a href="#/machines/list-by-customer/{{ Machine.customer_id }}">{{ Machine.customer_name }}</a> >
            {{ Machine.serial }}
        </div>

        <div id="commandbtns" class="col-md-4 padding-right-0 align-right">
            <a ng-href="#/machines/{{ Machine.id }}/edit" class="icon-white-button icon-white-button-edit" popover="Edit" popover-placement="bottom" popover-trigger="mouseenter" style="margin-left: 10px;"></a>
            <a class="icon-white-button icon-white-button-share" popover="Share" popover-placement="bottom" popover-trigger="mouseenter" md-Permalink style="margin-left: 10px;"></a>
            <a ng-click="deleteMachine()" class="icon-white-button icon-white-button-delete" popover="Delete" popover-placement="bottom" popover-trigger="mouseenter" style="margin-left: 10px;"></a>
            <a href="javascript:void(0);" onclick="window.print();" class="icon-white-button icon-white-button-print" popover="Print" popover-placement="bottom" popover-trigger="mouseenter" style="margin-left: 10px;"></a>
        </div>
    </section>
    
    <section id="section-details" class="animated fadeIn">
        <div id="section-mainimage">
            <a ng-show="Machine.img_full" href="{{ Machine.img_full }}" target="_blank" data-modal="lightbox" class="bordered-image main-image">
                <img ng-src="{{ Machine.img }}" src="images/tmp.png" />
            </a>
            <a ng-show="!Machine.img_full" class="bordered-image main-image">            
                <img ng-show="!Machine.img" ng-src="{{ Machine.img }}" src="images/tmp.png" />
            </a>
        </div>

        <div id="section-machine-details">
            <table class="table tbl-details">
                <caption>Machine Information</caption>
                <tbody>
                    <tr>
                        <td class="details-title">Serial Number</td>
                        <td class="details-value">{{ Machine.serial }}</td>
                        <td class="details-title">Hour Meter Operative</td>
                        <td class="details-value">
                            <span ng-show="Machine.hour_meter_operational==1">Yes</span>
                            <span ng-show="Machine.hour_meter_operational==0">No</span>
                            <span ng-show="Machine.hour_meter_operational==null">No Data</span>
                        </td>
                    <tr>
                        <td class="details-title">Manufacturer</td>
                        <td class="details-value">
                            <span ng-show="Machine.manufacturer_name">{{ Machine.manufacturer_name }}</span>
                            <span ng-show="!Machine.manufacturer_name">No Data</span>
                        </td>
                        <td class="details-title">Hours Per Week</td>
                        <td class="details-value">
                            <span ng-show="Inspections[0].inspection_obj.hours_per_week">{{ Inspections[0].inspection_obj.hours_per_week }}</span>
                            <span ng-show="!Inspections[0].inspection_obj.hours_per_week">No Data</span>
                        </td>
                    </tr>
                    <tr>
                        <td class="details-title">Model</td>
                        <td class="details-value">
                            <span ng-show="Machine.model">{{ Machine.model }}</span>
                            <span ng-show="!Machine.model">No Data</span>
                        </td>
                        <td class="details-title">Odometer Reading</td>
                        <td class="details-value">
                            <span ng-show="Inspections[0].inspection_obj.odometer_reading">{{ Inspections[0].inspection_obj.odometer_reading }}</span>
                            <span ng-show="!Inspections[0].inspection_obj.odometer_reading">0</span>
                        </td>
                    </tr>
                    <tr>
                        <td class="details-title">Customer</td>
                        <td class="details-value">
                            <span ng-show="Customer.name">{{ Customer.name }}</span>
                            <span ng-show="!Customer.name">No Data</span>
                        </td>
                        <td class="details-title">Reverse Odometer</td>
                        <td class="details-value">
                        	<span ng-show="Inspections[0].inspection_obj.reverse_odometer_reading">{{ Inspections[0].inspection_obj.reverse_odometer_reading }}</span>
                            <span ng-show="!Inspections[0].inspection_obj.reverse_odometer_reading">0</span>
                        </td>
                    </tr>
                    <tr>
                        <td class="details-title">Unit #</td>
                        <td class="details-value">
                            <span ng-show="Machine.equipment_id">{{ Machine.equipment_id }}</span>
                            <span ng-show="!Machine.equipment_id">No Data</span>
                        </td>
                        <td class="details-title">Hour Meter Reading</td>
                        <td class="details-value">
                        	<span ng-show="Machine.hour_meter_reading">{{ Machine.hour_meter_reading }}</span>
                        	<span ng-show="!Machine.hour_meter_reading">No Data</span>
                        </td>
                    </tr>
                    <tr>
                        <td class="details-title">Opportunity</td>
                        <td class="details-value">
                            {{ Machine.opportunity }}
                        </td>
                        <td class="details-title"></td>
                        <td class="details-value">                            
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </section>
    
    <section id="section-additional-details" class="row animated fadeIn">
        <div class="col-md-6 padding-left-0">
            <table class="table tbl-details">
                <caption>Inspection Information</caption>
                <tbody>
                    <tr>
                        <td class="details-title">Rating</td>
                        <td class="details-value">
                        	{{ Inspections[0].rating }}
                        </td>
                    </tr>
                    <tr>
                        <td class="details-title">Status</td>
                        <td class="details-value">
                        	<span ng-if="Inspections[0].completed==true">Completed</span>
							<span ng-if="Inspections[0].completed==false">Uncompleted</span>
                        </td>
                    </tr>
                    <tr>
                        <td class="details-title">Inspector</td>
                        <td class="details-value">
                        	{{ Inspections[0].inspector }}
                        </td>
                    </tr>
                    <tr>
                        <td class="details-title">Total Inspections</td>
                        <td class="details-value">
							{{ Inspections.length }}
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="col-md-6 padding-left-0">
            <table class="table tbl-details">
                <caption>Customer Information</caption>
                <tbody>
                    <tr>
                        <td class="details-title">Name</td>
                        <td class="details-value">
                            <a href="#/customers/{{ Customer.id }}">{{ Customer.name }}</a>
                        </td>
                    </tr>
                    <tr>
                        <td class="details-title">POC</td>
                        <td class="details-value">
                            
                        </td>
                    </tr>
                    <tr>
                        <td class="details-title">Email</td>
                        <td class="details-value">
                            <a ng-show="Customer.email" href="mailto:{{ Customer.email }}">{{ Customer.email }}</a>
                        </td>
                    </tr>
                    <tr>
                        <td class="details-title">Phone</td>
                        <td class="details-value">
                            {{ Customer.phone }}
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </section>
    
    <section id="section-inspections-header" class="row" ng-hide="true">
        <div class="col-md-8 padding-left-0">
            <a class="icon-white-button icon-white-button-share" popover="Share" popover-placement="bottom" popover-trigger="mouseenter" md-Permalink></a>
            <a class="icon-white-button icon-white-button-delete" popover="Delete" popover-placement="bottom" popover-trigger="mouseenter"></a>
            <a class="icon-white-button icon-white-button-print" popover="Print" popover-placement="bottom" popover-trigger="mouseenter"></a>
        </div>

        <div class="col-md-4 padding-right-0 align-right">
        	<input type="text" class="rounded3px input160w alignright" md-Autocomplete-Search="inspections" placeholder="Search Inspections" />
        </div>
    </section>
    
    <section id="section-inspections" class="row">
    	<table id="tbl-inspections" width="100%" ng-init="predicate='timestamp';reversed=true" class="gray-thead">
			<thead>
				<tr>
					<th sort predicate="'rating'" by="predicate" reversed="reversed">Rating</th>
			        <th sort predicate="'timestamp'" by="predicate" reversed="reversed">Date</th>
			        <th sort predicate="'inspector'" by="predicate" reversed="reversed">Inspector</th>
			        <th sort predicate="''" by="predicate" reversed="reversed">Email</th>
			        <th sort predicate="'completed'" by="predicate" reversed="reversed">Status</th>
			        <th sort predicate="'id'" by="predicate" reversed="reversed">Inspection Number</th>
			        <th sort predicate="'imagescounts'" by="predicate" reversed="reversed">Images</th>
					<th>&nbsp;</th>
				</tr>
			</thead>
			<tbody>
				<tr ng-repeat-start="Inspection in Inspections | orderBy:predicate:reversed">
					<td style="width: 90px; text-align: center; border-right: solid 1px #d2d2d2;" class="bghover-{{Inspection.color}}-light" ng-class="{'bg-{{Inspection.color}}-light' : Inspection.show_components == 1}">
						<span class="inspection-color bg-{{Inspection.color}}"></span>
						{{ Inspection.rating }}
						<div ng-if="Inspection.show_components==0" ng-click="Inspection.show_components = 1-Inspection.show_components" class="details-expander collapsed"></div>
						<div ng-if="Inspection.show_components==1" ng-click="Inspection.show_components = 1-Inspection.show_components" class="details-expander expanded"></div>
					</td>
					<td>{{ Inspection.datestring }}</td>
					<td>{{ Inspection.inspector }}</td>
					<td></td>
					<td>
						<span ng-if="Inspection.completed==true">Completed</span>
						<span ng-if="Inspection.completed==false">Uncompleted</span>
					</td>
					<td>
						<a href="#/inspections/{{Inspection.id}}">IN #{{ Inspection.id }}</a>
					</td>
					<td>{{ Inspection.imagescount }}</td>
					<td>
						<a ng-href="#inspections/{{ Inspection.id }}" class="green-button-view"></a>
					</td>
				</tr>
				<tr ng-repeat-end>
					<td colspan="8" style="padding: 0px;">
						<table width="100%" ng-show="Inspection.show_components==1" class="tbl-components">
							<tr ng-repeat-start="comp in Inspection.components" class="row bg-{{comp.left.color}}-light">
								<td style="width: 80px; text-align: center;">
									<div class="{{usv_component[comp.component_type].icon_cls}} inspection-components-particon"></div>
								</td>
								<td>
									<div class="inspection-components-percentage text-{{comp.left.color}}">{{comp.left.percentage}}</span>
								</td>
								<td>L {{usv_component[comp.component_type].name}}</td>
								<td>
									<img class="component-tool-icon" src="./images/icons/measuring-tape-icon.png" ng-if="comp.left.tool_name == 'Tape Measure'"/>
	                                <img class="component-tool-icon" src="./images/icons/ultrasonic-icon.png" ng-if="comp.left.tool_name == 'Ultrasonic'"/>
	                                <img class="component-tool-icon" src="./images/icons/depth-gauge-icon.png" ng-if="comp.left.tool_name == 'Depth Gauge'"/>
	                                <img class="component-tool-icon" src="./images/icons/caliper-icon.png" ng-if="comp.left.tool_name == 'Caliper'"/>
	                                <div class="inspection-components-measured">{{ comp.left.measured | unit:'inches':UserSettings.show_metric }}</div>
	                            </td>
							</tr>
							<tr ng-repeat-end class="row bg-{{comp.right.color}}-light">
								<td style="width: 80px; text-align: center;">
									<div class="{{usv_component[comp.component_type].icon_cls}} inspection-components-particon"></div>
								</td>
								<td>
									<div class="inspection-components-percentage text-{{comp.right.color}}">{{comp.right.percentage}}</div>
								</td>
								<td>R {{usv_component[comp.component_type].name}}</td>
								<td>
									<img class="component-tool-icon" src="./images/icons/measuring-tape-icon.png" ng-if="comp.right.tool_name == 'Tape Measure'"/>
	                                <img class="component-tool-icon" src="./images/icons/ultrasonic-icon.png" ng-if="comp.right.tool_name == 'Ultrasonic'"/>
	                                <img class="component-tool-icon" src="./images/icons/depth-gauge-icon.png" ng-if="comp.right.tool_name == 'Depth Gauge'"/>
	                                <img class="component-tool-icon" src="./images/icons/caliper-icon.png" ng-if="comp.right.tool_name == 'Caliper'"/>
	                                <div class="inspection-components-measured">{{ comp.right.measured | unit:'inches':UserSettings.show_metric }}</div>
	                            </td>
							</tr>
						</table>
					</td>
				</tr>
			</tbody>
		</table>
    </section>
    
</div>
<script src="./scripts/ui/modals.js"></script>
