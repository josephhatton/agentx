Modustri.controller("CustomerAddCtrl",["$log","$scope","$routeParams","$location","CustomerServices","AuthServices","UserServices","Utilities",function(e,t,s,r,o,a,u,i){"use strict";a.checkUserCreds(),t.UserSettings=a.getUserSettings(),t.new_customer=!0,t.image_upload="",t.Customer=o.getEmptyCustomer(),t.cancelCustomer=function(){r.path("/customers/list")},t.saveCustomer=function(){if(!i.validateForm(t.customer_form))return!1;var e=!0;o.getByName(t.Customer.name).then(function(s){if(s.data.results.length>0)for(var i=0;i<s.data.results.length;i++)if(s.data.results[i].id!=t.Customer.id&&t.Customer.name==s.data.results[i].name){e=!1;break}if(!e)return alert("Duplicate name exists."),!1;var m={};delete t.Customer.archived,u.saveContact(t.Customer.email).then(function(e){t.Customer.primary_contact_id=e.hasOwnProperty("data")?e.data.results.id:0,o.saveNew(t.Customer).then(function(e){""!==t.image_upload?(m={customer_obj:e.data.results,file:t.image_upload,description:"Customer photo",user_id:a.getUserID()},o.savePhoto(m).then(function(e){t.$emit("obj_saved","Customer"),alert("Customer saved."),r.path("/customers/list")})):(t.$emit("obj_saved","Customer"),alert("Customer saved."),r.path("/customers/list"))})})})},t.deleteCustomer=function(){alert("There is no customer to delete.")}}]);
//# sourceMappingURL=./customer-add-min.js.map