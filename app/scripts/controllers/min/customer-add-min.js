Modustri.controller("CustomerAddCtrl",["$log","$scope","$routeParams","$location","CustomerServices","AuthServices","UserServices",function(e,t,s,r,o,a,u){"use strict";a.checkUserCreds(),t.UserSettings=a.getUserSettings(),t.new_customer=!0,t.image_upload="",t.Customer=o.getEmptyCustomer(),t.cancelCustomer=function(){r.path("/customers/list")},t.saveCustomer=function(){if(""==t.Customer.name)return void alert("Can not create a blank customer.");var e={};delete t.Customer.archived,u.saveContact(t.Customer.email).then(function(s){t.Customer.primary_contact_id=s.hasOwnProperty("data")?s.data.results.id:0,o.saveNew(t.Customer).then(function(s){""!==t.image_upload?(e={customer_obj:s.data.results,file:t.image_upload,description:"Customer photo",user_id:a.getUserID()},o.savePhoto(e).then(function(e){t.$emit("obj_saved","Customer"),alert("Customer saved."),r.path("/customers/list")})):(t.$emit("obj_saved","Customer"),alert("Customer saved."),r.path("/customers/list"))})})},t.deleteCustomer=function(){alert("There is no customer to delete.")}}]);